<!-- Corrections Test Suite-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SilentStacks Performance Testing Suite - Corrected</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        h1 { color: #2c3e50; text-align: center; }
        h2 { color: #34495e; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: #fafafa;
        }
        .test-controls {
            display: flex;
            gap: 15px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        .btn-primary { background: #3498db; color: white; }
        .btn-primary:hover { background: #2980b9; transform: translateY(-1px); }
        .btn-success { background: #27ae60; color: white; }
        .btn-success:hover { background: #229954; transform: translateY(-1px); }
        .btn-danger { background: #e74c3c; color: white; }
        .btn-danger:hover { background: #c0392b; transform: translateY(-1px); }
        .btn-warning { background: #f39c12; color: white; }
        .btn-warning:hover { background: #d68910; transform: translateY(-1px); }
        .progress-container {
            margin: 15px 0;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
        }
        .progress-bar {
            height: 20px;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
        }
        .results {
            margin-top: 20px;
            padding: 15px;
            background: #ecf0f1;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            max-height: 300px;
            overflow-y: auto;
        }
        .metric {
            display: inline-block;
            margin: 5px 10px;
            padding: 8px 15px;
            background: #34495e;
            color: white;
            border-radius: 20px;
            font-size: 14px;
        }
        .metric.good { background: #27ae60; }
        .metric.warning { background: #f39c12; }
        .metric.danger { background: #e74c3c; }
        .performance-monitor {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            z-index: 10000;
            min-width: 200px;
        }
        .monitor-metric {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
        }
        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        .status-pass { background: #27ae60; }
        .status-fail { background: #e74c3c; }
        .status-warning { background: #f39c12; }
        .status-running { background: #3498db; animation: pulse 1s infinite; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .index-verification {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .critical-finding {
            background: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        .warning-finding {
            background: #f39c12;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        .success-finding {
            background: #27ae60;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        .performance-chart {
            width: 100%;
            height: 200px;
            background: #34495e;
            border-radius: 8px;
            margin: 15px 0;
            position: relative;
            overflow: hidden;
        }
        .chart-bar {
            position: absolute;
            bottom: 0;
            background: linear-gradient(to top, #3498db, #2ecc71);
            transition: height 0.5s ease;
            color: white;
            font-size: 10px;
            text-align: center;
            padding-top: 5px;
        }
    </style>
</head>
<body>
    <!-- Performance Monitor -->
    <div class="performance-monitor" id="performance-monitor">
        <h4 style="margin: 0 0 10px 0;">üîç Live Performance</h4>
        <div class="monitor-metric">
            <span>Memory:</span>
            <span id="memory-usage">0 MB</span>
        </div>
        <div class="monitor-metric">
            <span>DOM Nodes:</span>
            <span id="dom-nodes">0</span>
        </div>
        <div class="monitor-metric">
            <span>FPS:</span>
            <span id="fps">60</span>
        </div>
        <div class="monitor-metric">
            <span>Status:</span>
            <span id="test-status">Ready</span>
        </div>
    </div>

    <div class="container">
        <h1>üß™ SilentStacks Performance Testing Suite</h1>
        <p style="text-align: center; color: #7f8c8d; font-size: 18px;">
            <strong>CORRECTED VERSION</strong> - Accurate Performance Measurements & Index.html Verification
        </p>

        <!-- Index.html Verification -->
        <div class="index-verification">
            <h2>üìã Index.html Verification</h2>
            <div id="index-verification-results">
                <div>‚úÖ Checking file structure and dependencies...</div>
                <div>‚úÖ Verifying module loading order...</div>
                <div>‚úÖ Validating CSS path references...</div>
                <div>‚úÖ Testing JavaScript module registration...</div>
            </div>
            <button class="btn btn-primary" onclick="verifyIndexHTML()" style="margin-top: 15px;">
                üîç Verify Index.html Configuration
            </button>
        </div>

        <!-- Corrected Performance Metrics -->
        <div class="test-section">
            <h2>üìä Corrected Performance Benchmark Results</h2>
            <div id="corrected-metrics">
                <span class="metric" id="total-tests-corrected">Tests: 0/15</span>
                <span class="metric" id="passed-tests-corrected">Passed: 0</span>
                <span class="metric" id="failed-tests-corrected">Failed: 0</span>
                <span class="metric" id="warnings-corrected">Warnings: 0</span>
                <span class="metric" id="runtime-corrected">Runtime: 0s</span>
            </div>
            
            <div class="test-controls">
                <button class="btn btn-success" onclick="runCorrectedTests()">üöÄ Run Corrected Tests</button>
                <button class="btn btn-primary" onclick="runMemoryLeakTest()">üß† Memory Leak Test</button>
                <button class="btn btn-warning" onclick="runBreakingPointTest()">‚ö° Breaking Point Test</button>
                <button class="btn btn-danger" onclick="runStressTest()">üî• Massive Stress Test</button>
            </div>
            
            <div class="progress-container">
                <div class="progress-bar" id="corrected-progress" style="width: 0%">Ready to Start</div>
            </div>
        </div>

        <!-- Performance Visualization -->
        <div class="test-section">
            <h2>üìà Real-Time Performance Visualization</h2>
            <div class="performance-chart" id="performance-chart">
                <!-- Performance bars will be dynamically generated -->
            </div>
            <div class="test-controls">
                <button class="btn btn-primary" onclick="startRealTimeMonitoring()">üìä Start Monitoring</button>
                <button class="btn btn-warning" onclick="stopRealTimeMonitoring()">‚èπÔ∏è Stop Monitoring</button>
                <button class="btn btn-danger" onclick="clearChart()">üßπ Clear Chart</button>
            </div>
        </div>

        <!-- Critical Findings -->
        <div class="test-section">
            <h2>üö® Critical Findings & Corrections</h2>
            <div id="critical-findings">
                <!-- Dynamic findings will appear here -->
            </div>
        </div>

        <!-- Test Grid -->
        <div class="test-grid">
            
            <!-- Memory Leak Detection -->
            <div class="test-section">
                <h3>üß† Memory Leak Detection</h3>
                <div class="test-controls">
                    <button class="btn btn-primary" onclick="testMemoryLeaks()">Detect Leaks</button>
                    <button class="btn btn-warning" onclick="simulateHeavyUsage()">Heavy Usage</button>
                    <button class="btn btn-danger" onclick="forceGarbageCollection()">Force GC</button>
                </div>
                <div id="memory-leak-results" class="results">
                    <div>üéØ Monitoring: Heap size, DOM nodes, Event listeners</div>
                    <div>‚ö†Ô∏è Threshold: &lt;400MB sustained, &lt;5000 DOM nodes</div>
                    <div>üîç Detection: Memory growth patterns over time</div>
                </div>
            </div>

            <!-- Breaking Point Analysis -->
            <div class="test-section">
                <h3>‚ö° Breaking Point Analysis</h3>
                <div class="test-controls">
                    <button class="btn btn-primary" onclick="testProgressiveLoad()">Progressive Load</button>
                    <button class="btn btn-warning" onclick="testConcurrentOps()">Concurrent Ops</button>
                    <button class="btn btn-danger" onclick="testBrowserLimits()">Browser Limits</button>
                </div>
                <div id="breaking-point-results" class="results">
                    <div>üéØ Finding: Maximum safe operation thresholds</div>
                    <div>‚ö†Ô∏è Critical: Points where performance degrades</div>
                    <div>üí• Breaking: Where browser becomes unresponsive</div>
                </div>
            </div>

            <!-- Corrected API Performance -->
            <div class="test-section">
                <h3>üåê Corrected API Performance</h3>
                <div class="test-controls">
                    <button class="btn btn-primary" onclick="testAPIRateLimiting()">Rate Limiting</button>
                    <button class="btn btn-primary" onclick="testConcurrentAPICalls()">Concurrent Calls</button>
                    <button class="btn btn-primary" onclick="testOfflineQueue()">Offline Queue</button>
                </div>
                <div id="corrected-api-results" class="results">
                    <div>üöÄ Accurate timing measurements</div>
                    <div>üìä Real success/failure rates</div>
                    <div>‚è±Ô∏è Proper rate limit compliance</div>
                </div>
            </div>

            <!-- Real-World Simulation -->
            <div class="test-section">
                <h3>üåç Real-World Usage Simulation</h3>
                <div class="test-controls">
                    <button class="btn btn-primary" onclick="simulate4HourSession()">4-Hour Session</button>
                    <button class="btn btn-primary" onclick="simulateMultipleUploads()">Multiple Uploads</button>
                    <button class="btn btn-primary" onclick="simulateHeavyUser()">Heavy User</button>
                </div>
                <div id="real-world-results" class="results">
                    <div>üë• Simulating real user patterns</div>
                    <div>üìä Measuring degradation over time</div>
                    <div>üîÑ Testing recovery mechanisms</div>
                </div>
            </div>

            <!-- Browser Compatibility Matrix -->
            <div class="test-section">
                <h3>üåç Browser Compatibility Matrix</h3>
                <div class="test-controls">
                    <button class="btn btn-primary" onclick="testCurrentBrowser()">Test Current</button>
                    <button class="btn btn-primary" onclick="simulateOtherBrowsers()">Simulate Others</button>
                    <button class="btn btn-primary" onclick="testMobileCompatibility()">Mobile Test</button>
                </div>
                <div id="browser-compat-results" class="results">
                    <div>üèÉ Browser: <span id="current-browser">Detecting...</span></div>
                    <div>üì± Mobile: <span id="mobile-detection">Testing...</span></div>
                    <div>üéØ Compatibility Score: <span id="compat-score">0%</span></div>
                </div>
            </div>

            <!-- Performance Optimization -->
            <div class="test-section">
                <h3>üéØ Performance Optimization</h3>
                <div class="test-controls">
                    <button class="btn btn-primary" onclick="analyzeBottlenecks()">Find Bottlenecks</button>
                    <button class="btn btn-success" onclick="suggestOptimizations()">Suggest Fixes</button>
                    <button class="btn btn-warning" onclick="implementOptimizations()">Apply Fixes</button>
                </div>
                <div id="optimization-results" class="results">
                    <div>üîç Analyzing performance bottlenecks</div>
                    <div>üí° Suggesting optimization strategies</div>
                    <div>üöÄ Implementing performance improvements</div>
                </div>
            </div>

        </div>

        <!-- Detailed Test Results -->
        <div class="test-section">
            <h2>üìà Detailed Corrected Test Results</h2>
            <div id="detailed-corrected-results" class="results" style="max-height: 600px;">
                Corrected test results will appear here...
            </div>
        </div>

    </div>

    <script>
        // Global test state
        let correctedTestState = {
            totalTests: 15,
            passedTests: 0,
            failedTests: 0,
            warningTests: 0,
            startTime: null,
            memoryBaseline: 0,
            performanceData: [],
            monitoringInterval: null,
            chartInterval: null
        };

        // Performance monitoring
        let performanceInterval;
        let frameCount = 0;
        let lastFrameTime = performance.now();

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initCorrectedMonitoring();
            detectBrowserCapabilities();
            logCorrected('üß™ Corrected Performance Testing Suite initialized');
            logCorrected('üí° This version provides accurate measurements and real breaking points');
        });

        function initCorrectedMonitoring() {
            startFPSMonitoring();
            
            performanceInterval = setInterval(() => {
                updateMemoryUsage();
                updateDOMNodes();
            }, 1000);
            
            // Set baseline memory
            if (performance.memory) {
                correctedTestState.memoryBaseline = performance.memory.usedJSHeapSize;
            }
        }

        function detectBrowserCapabilities() {
            const userAgent = navigator.userAgent;
            let browserName = 'Unknown';
            
            if (userAgent.includes('Chrome')) browserName = 'Chrome';
            else if (userAgent.includes('Firefox')) browserName = 'Firefox';
            else if (userAgent.includes('Safari')) browserName = 'Safari';
            else if (userAgent.includes('Edge')) browserName = 'Edge';
            
            document.getElementById('current-browser').textContent = browserName;
            
            // Mobile detection
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);
            document.getElementById('mobile-detection').textContent = isMobile ? 'Mobile Device' : 'Desktop';
            
            // Compatibility scoring
            let compatScore = 0;
            if (typeof localStorage !== 'undefined') compatScore += 20;
            if (typeof fetch !== 'undefined') compatScore += 20;
            if (CSS.supports('display', 'grid')) compatScore += 20;
            if (CSS.supports('display', 'flex')) compatScore += 20;
            if (typeof performance.memory !== 'undefined') compatScore += 20;
            
            document.getElementById('compat-score').textContent = `${compatScore}%`;
        }

        function updateMemoryUsage() {
            if (performance.memory) {
                const used = Math.round(performance.memory.usedJSHeapSize / 1024 / 1024);
                document.getElementById('memory-usage').textContent = `${used} MB`;
                
                // Update color based on usage
                const memoryEl = document.getElementById('memory-usage');
                if (used > 500) {
                    memoryEl.style.color = '#e74c3c';
                } else if (used > 200) {
                    memoryEl.style.color = '#f39c12';
                } else {
                    memoryEl.style.color = '#27ae60';
                }
                
                // Store for analysis
                correctedTestState.performanceData.push({
                    timestamp: Date.now(),
                    memory: used,
                    domNodes: document.getElementsByTagName('*').length
                });
                
                // Keep only last 100 data points
                if (correctedTestState.performanceData.length > 100) {
                    correctedTestState.performanceData.shift();
                }
            }
        }

        function updateDOMNodes() {
            const nodeCount = document.getElementsByTagName('*').length;
            document.getElementById('dom-nodes').textContent = nodeCount;
        }

        function startFPSMonitoring() {
            function countFrame() {
                frameCount++;
                requestAnimationFrame(countFrame);
            }
            
            requestAnimationFrame(countFrame);
            
            setInterval(() => {
                const fps = Math.round(frameCount);
                document.getElementById('fps').textContent = fps;
                frameCount = 0;
                
                // Color code FPS
                const fpsEl = document.getElementById('fps');
                if (fps < 30) {
                    fpsEl.style.color = '#e74c3c';
                } else if (fps < 50) {
                    fpsEl.style.color = '#f39c12';
                } else {
                    fpsEl.style.color = '#27ae60';
                }
            }, 1000);
        }

        // Index.html Verification
        async function verifyIndexHTML() {
            logCorrected('üîç Verifying index.html configuration...');
            const verificationResults = [];
            
            try {
                // Check CSS path
                const cssLinks = document.querySelectorAll('link[rel="stylesheet"]');
                const hasCorrectCSS = Array.from(cssLinks).some(link => 
                    link.href.includes('assets/css/style.css')
                );
                verificationResults.push({
                    test: 'CSS Path Verification',
                    result: hasCorrectCSS,
                    details: hasCorrectCSS ? 'assets/css/style.css found' : 'CSS path incorrect'
                });
                
                // Check script loading order
                const scripts = Array.from(document.querySelectorAll('script[src]'));
                const scriptOrder = scripts.map(s => s.src.split('/').pop());
                const hasDataManager = scriptOrder.includes('data-manager.js');
                verificationResults.push({
                    test: 'Script Loading Order',
                    result: hasDataManager,
                    details: `DataManager found: ${hasDataManager}`
                });
                
                // Check external dependencies
                const hasFuse = typeof Fuse !== 'undefined';
                const hasPapa = typeof Papa !== 'undefined';
                verificationResults.push({
                    test: 'External Dependencies',
                    result: hasFuse && hasPapa,
                    details: `Fuse.js: ${hasFuse}, PapaParse: ${hasPapa}`
                });
                
                // Check module registration
                const hasModules = window.SilentStacks && window.SilentStacks.modules;
                verificationResults.push({
                    test: 'Module Registration',
                    result: hasModules,
                    details: hasModules ? `${Object.keys(window.SilentStacks.modules).length} modules` : 'No modules found'
                });
                
                // Display results
                const resultsHTML = verificationResults.map(r => 
                    `<div style="color: ${r.result ? '#27ae60' : '#e74c3c'};">
                        ${r.result ? '‚úÖ' : '‚ùå'} ${r.test}: ${r.details}
                    </div>`
                ).join('');
                
                document.getElementById('index-verification-results').innerHTML = resultsHTML;
                
                const passCount = verificationResults.filter(r => r.result).length;
                logCorrected(`üìã Index.html verification: ${passCount}/${verificationResults.length} checks passed`);
                
                return passCount === verificationResults.length;
                
            } catch (error) {
                logCorrected(`‚ùå Index.html verification failed: ${error.message}`);
                return false;
            }
        }

        // Corrected Performance Tests
        async function runCorrectedTests() {
            logCorrected('üöÄ Starting corrected performance test suite...');
            correctedTestState.startTime = performance.now();
            correctedTestState.passedTests = 0;
            correctedTestState.failedTests = 0;
            correctedTestState.warningTests = 0;
            
            updateCorrectedProgress(0, 'Initializing corrected tests...');
            
            try {
                // Run comprehensive corrected tests
                await testMemoryLeaks();
                await testProgressiveLoad();
                await testAPIRateLimiting();
                await testRealWorldUsage();
                await testBrowserSpecificLimits();
                
                const endTime = performance.now();
                const totalTime = Math.round((endTime - correctedTestState.startTime) / 1000);
                
                updateCorrectedProgress(100, `Corrected tests completed in ${totalTime}s`);
                updateCorrectedMetrics();
                
                // Generate findings
                generateCriticalFindings();
                
                logCorrected(`üéâ Corrected test suite completed! ${correctedTestState.passedTests} passed, ${correctedTestState.failedTests} failed, ${correctedTestState.warningTests} warnings`);
                
            } catch (error) {
                logCorrected(`‚ùå Corrected test suite failed: ${error.message}`);
                updateCorrectedProgress(0, 'Corrected test suite failed');
            }
        }

        // Memory Leak Tests
        async function testMemoryLeaks() {
            logCorrected('üß† Testing for memory leaks...');
            
            try {
                const initialMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;
                const initialNodes = document.getElementsByTagName('*').length;
                
                // Simulate multiple operations that could cause leaks
                for (let cycle = 0; cycle < 5; cycle++) {
                    logCorrected(`  Cycle ${cycle + 1}/5: Simulating heavy operations...`);
                    
                    // Simulate bulk data operations
                    await simulateBulkOperations(1000);
                    
                    // Force garbage collection if available
                    if (window.gc) {
                        window.gc();
                    }
                    
                    // Wait for cleanup
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const currentMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;
                    const currentNodes = document.getElementsByTagName('*').length;
                    
                    const memoryGrowth = currentMemory - initialMemory;
                    const nodeGrowth = currentNodes - initialNodes;
                    
                    logCorrected(`    Memory growth: ${Math.round(memoryGrowth / 1024 / 1024)}MB, DOM nodes: +${nodeGrowth}`);
                }
                
                const finalMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;
                const finalNodes = document.getElementsByTagName('*').length;
                
                const totalMemoryGrowth = (finalMemory - initialMemory) / 1024 / 1024;
                const totalNodeGrowth = finalNodes - initialNodes;
                
                // Determine if there's a leak
                const hasMemoryLeak = totalMemoryGrowth > 100; // More than 100MB retained
                const hasDOMNodeLeak = totalNodeGrowth > 500; // More than 500 nodes retained
                
                const result = !hasMemoryLeak && !hasDOMNodeLeak;
                logCorrectedTestResult('Memory Leak Test', result, 
                    `Memory: +${Math.round(totalMemoryGrowth)}MB, DOM: +${totalNodeGrowth} nodes`);
                
                if (result) correctedTestState.passedTests++;
                else correctedTestState.failedTests++;
                
                // Store in memory leak results
                const memoryResults = document.getElementById('memory-leak-results');
                const resultDiv = document.createElement('div');
                resultDiv.innerHTML = `${result ? '‚úÖ' : '‚ùå'} Memory growth: ${Math.round(totalMemoryGrowth)}MB (${hasMemoryLeak ? 'LEAK DETECTED' : 'acceptable'})`;
                resultDiv.style.color = result ? '#27ae60' : '#e74c3c';
                memoryResults.appendChild(resultDiv);
                
            } catch (error) {
                logCorrectedTestResult('Memory Leak Test', false, error.message);
                correctedTestState.failedTests++;
            }
        }

        // Progressive Load Testing
        async function testProgressiveLoad() {
            logCorrected('‚ö° Testing progressive load breaking points...');
            
            try {
                const loadSizes = [100, 500, 1000, 2500, 5000, 7500, 10000];
                const results = [];
                
                for (const size of loadSizes) {
                    logCorrected(`  Testing ${size} records...`);
                    
                    const startTime = performance.now();
                    const startMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;
                    
                    // Simulate loading data
                    await simulateBulkOperations(size);
                    
                    const endTime = performance.now();
                    const endMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;
                    
                    const loadTime = endTime - startTime;
                    const memoryUsed = (endMemory - startMemory) / 1024 / 1024;
                    
                    const isAcceptable = loadTime < (size * 10) && memoryUsed < (size * 0.1);
                    
                    results.push({
                        size,
                        loadTime: Math.round(loadTime),
                        memoryUsed: Math.round(memoryUsed),
                        acceptable: isAcceptable
                    });
                    
                    logCorrected(`    ${size} records: ${Math.round(loadTime)}ms, ${Math.round(memoryUsed)}MB (${isAcceptable ? 'PASS' : 'FAIL'})`);
                    
                    // Clear data to prevent cumulative effects
                    await clearTestData();
                }
                
                // Find breaking point
                const breakingPoint = results.find(r => !r.acceptable);
                const safeLimit = breakingPoint ? 
                    results[results.indexOf(breakingPoint) - 1]?.size || 100 : 
                    loadSizes[loadSizes.length - 1];
                
                const success = safeLimit >= 2000; // Should handle at least 2000 records safely
                logCorrectedTestResult('Progressive Load Test', success, 
                    `Safe limit: ${safeLimit} records, Breaking point: ${breakingPoint?.size || 'Not found'}`);
                
                if (success) correctedTestState.passedTests++;
                else if (safeLimit >= 1000) correctedTestState.warningTests++;
                else correctedTestState.failedTests++;
                
                // Store results
                const breakingResults = document.getElementById('breaking-point-results');
                results.forEach(r => {
                    const resultDiv = document.createElement('div');
